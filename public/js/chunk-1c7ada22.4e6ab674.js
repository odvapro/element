(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1c7ada22"],{"0674":function(e,t,a){},"21e6":function(e,t,a){"use strict";a.r(t);a("b54a"),a("7f7f"),a("f386");var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"em-file-item-col",on:{click:function(t){return e.openPopup()}}},[e._l(e.localValue,(function(a){return a.noShow?e._e():t("div",{staticClass:"em-file-item-wrapper"},["image"==a.type?t("img",{attrs:{src:a.sizes.small.path,alt:""}}):t("svg",[t("use",{attrs:{"xlink:href":"#attachment"}})])])})),0==e.countFiels?[t("span",{staticClass:"el-empty"},[e._v(e._s(e.$t("empty")))])]:e._e(),e.showPopup?t("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.closePopup,expression:"closePopup"}],staticClass:"em-file__edit"},[e._l(e.localValue,(function(a,i){return a.noShow?e._e():t("div",{staticClass:"em-file__edit-item"},["image"==a.type?t("img",{staticClass:"em-file__edit-attach",attrs:{src:a.sizes.small.path,alt:""}}):t("svg",{staticClass:"em-file__edit-attach"},[t("use",{attrs:{"xlink:href":"#attachment"}})]),t("a",{attrs:{href:a.path,target:"_blank"}},[e._v("Download")]),t("a",{attrs:{href:"javascript:void(0);"},on:{click:function(t){return e.removeFile(i)}}},[e._v(e._s(e.$t("remove")))])])})),0==e.countFiels?[t("div",{staticClass:"em-file__empty-pop"},[t("span",{staticClass:"el-empty"},[e._v(e._s(e.$t("fieldEmFile.no_files")))])])]:e._e(),t("button",{staticClass:"el-gbtn",on:{click:function(t){return e.openSubPopup()}}},[e._v(e._s(e.$t("fieldEmFile.add_file")))]),e.showSubPopup?t("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.closeSubPopup,expression:"closeSubPopup"}],staticClass:"em-file__upload-popup"},[t("div",{staticClass:"em-file__upload-tab-wrapper"},[t("div",{staticClass:"em-file__upload-tabs-head"},e._l(e.tabs,(function(a){return t("div",{staticClass:"em-file__upload-tab-item",class:{active:a.active},on:{click:function(t){return e.setActiveTab(a)}}},[e._v(e._s(a.name))])})),0),t("div",{staticClass:"em-file__upload-tabs-content-wrapper"},[e.isUploading?t("div",{staticClass:"em-file__progress-tab"},[t("div",{staticClass:"em-file__progressbar"},[t("div",{staticClass:"em-file__progressbar-text"},[e._v(e._s(e.percentUploadOfProgress)+"%")]),t("div",{staticClass:"em-file__progressbar-done",style:{width:e.percentUploadOfProgress+"%"}})]),t("button",{staticClass:"el-gbtn",on:{click:e.cancelUpload}},[e._v(e._s(e.$t("cancel")))])]):[e.activeTab==e.$t("upload")?t("div",{staticClass:"em-file__file-tab"},[t("input",{ref:"emFile",staticClass:"em-file",attrs:{type:"file",multiple:"true",name:"file",id:"file"},on:{change:function(t){return e.uploadFile("file")}}}),t("label",{staticClass:"el-btn",attrs:{for:"file"}},[e._v(e._s(e.$t("fieldEmFile.choose_file")))])]):e._e(),e.activeTab==e.$t("upload_by_link")?t("div",{staticClass:"em-file__link-tab"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.link,expression:"link"}],staticClass:"el-inp em-file__embed-input",attrs:{type:"text",placeholder:e.$t("paste_link")},domProps:{value:e.link},on:{change:function(t){return e.uploadFile("link")},input:function(t){t.target.composing||(e.link=t.target.value)}}}),t("button",{staticClass:"el-btn",on:{click:function(t){return e.uploadFile("link")}}},[e._v(e._s(e.$t("fieldEmFile.embed_link")))])]):e._e()]],2)])]):e._e()],2):e._e()],2)},n=[],s=(a("ac4d"),a("8a81"),a("5df3"),a("1c4c"),a("6b54"),a("4917"),a("96cf"),a("3b8d")),l=a("bc3a"),o=a.n(l);function r(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=c(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,l=!0,o=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return l=e.done,e},e:function(e){o=!0,s=e},f:function(){try{l||null==a.return||a.return()}finally{if(o)throw s}}}}function c(e,t){if(e){if("string"==typeof e)return u(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,i=Array(t);a<t;a++)i[a]=e[a];return i}var p={props:["fieldValue","fieldSettings","mode","view"],data:function(){return{localValue:!1,showPopup:!1,showSubPopup:!1,tabs:[{name:this.$t("upload"),active:!0},{name:this.$t("upload_by_link"),active:!1}],activeTab:this.$t("upload"),link:"",percentUploadOfProgress:0,isUploading:!1,cancelToken:null}},computed:{countFiels:function(){var e=0;if(!this.localValue)return e;for(var t in this.localValue)this.localValue[t].noShow||e++;return e},fieldCode:function(){return"undefined"!==typeof this.fieldSettings.fieldCode&&this.fieldSettings.fieldCode},tableCode:function(){return"undefined"!==typeof this.fieldSettings.tableCode&&this.fieldSettings.tableCode}},methods:{uploadFile:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a,i,n,s,l,c,u,p,d=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.localValue||this.$set(this,"localValue",[]),a=new FormData,a.append("tableCode",this.tableCode),a.append("fieldCode",this.fieldCode),"link"!=t){e.next=9;break}a.append("typeUpload","link"),a.append("link",this.link),e.next=18;break;case 9:if("file"!=t){e.next=17;break}if("undefined"!=typeof this.$refs.emFile&&0!=this.$refs.emFile.length){e.next=12;break}return e.abrupt("return");case 12:i=r(this.$refs.emFile.files);try{for(i.s();!(n=i.n()).done;)s=n.value,a.append("".concat(this.fieldCode,"[]"),s)}catch(f){i.e(f)}finally{i.f()}a.append("typeUpload","file"),e.next=18;break;case 17:return e.abrupt("return");case 18:return"table"==this.view&&a.append("prepareForSave",!0),this.cancelToken=o.a.CancelToken.source(),this.setUploadProgressStatus(!0),e.next=23,o()({method:"POST",data:a,headers:{"Content-Type":"multipart/form-data"},url:"/field/em_file/index/upload/",cancelToken:this.cancelToken.token,onUploadProgress:function(e){d.updateUploadProgress({loaded:e.loaded,total:e.total})}}).catch((function(e){if(e.__proto__.__CANCEL__)return{data:{success:!1,message:e.message}}}));case 23:if(l=e.sent,this.setUploadProgressStatus(!1),l.data.success){e.next=28;break}return this.ElMessage.error(l.data.message),e.abrupt("return",!1);case 28:c=r(l.data.value);try{for(c.s();!(u=c.n()).done;)p=u.value,this.localValue.push(p)}catch(f){c.e(f)}finally{c.f()}this.sendValue(),this.closeSubPopup();case 32:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),setUploadProgressStatus:function(e){this.clearUploadProgress(),this.$set(this,"isUploading",!!e)},updateUploadProgress:function(e){var t=e.percent,a=void 0===t?0:t,i=e.loaded,n=void 0===i?0:i,s=e.total,l=void 0===s?0:s;!a&&l&&(a=Math.floor(100*n/l)),a<0?this.$set(this,"percentUploadOfProgress",0):a>100?this.$set(this,"percentUploadOfProgress",100):this.$set(this,"percentUploadOfProgress",a)},clearUploadProgress:function(){this.$set(this,"percentUploadOfProgress",0)},cancelUpload:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.cancelToken){e.next=5;break}return e.next=3,this.cancelToken.cancel(this.$t("fieldEmFile.uploading_canceled_by_the_user"));case 3:e.sent,this.cancelToken=null;case 5:this.clearUploadProgress();case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),removeFile:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("undefined"==typeof this.localValue[t].new){e.next=4;break}return this.$delete(this.localValue,t),this.sendValue(),e.abrupt("return");case 4:this.$set(this.localValue[t],"delete",!0),this.$set(this.localValue[t],"noShow",!0),this.sendValue();case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),sendValue:function(e){this.$emit("onChange",{value:this.localValue,settings:this.fieldSettings,tableCode:this.tableCode,fieldCode:this.fieldCode})},setPreviewForImage:function(e,t){null==e.match(/\.(jpeg|jpg|gif|png)$/)&&(e=!1),this.setPreview(e,t)},setPreview:function(e,t){var a=this.localValue[t];a.type=0==e?"no-image":"image",a.sizes={small:{path:e}},this.$set(this.localValue,t,a)},setActiveTab:function(e){if(this.isUploading)return!1;var t,a=r(this.tabs);try{for(a.s();!(t=a.n()).done;){var i=t.value;i.active=!1}}catch(n){a.e(n)}finally{a.f()}e.active=!0,this.activeTab=e.name},openPopup:function(){this.showPopup=!0},openSubPopup:function(){this.showSubPopup=!0},closePopup:function(){this.showPopup=!1,this.closeSubPopup()},closeSubPopup:function(){this.showSubPopup=!1}},watch:{fieldValue:function(e){this.localValue=e}},created:function(){this.localValue=this.fieldValue}},d=p,f=(a("ec75"),a("2877")),h=Object(f["a"])(d,i,n,!1,null,null,null);t["default"]=h.exports},ec75:function(e,t,a){"use strict";a("0674")},f386:function(e,t,a){"use strict";a("386b")("small",(function(e){return function(){return e(this,"small","","")}}))}}]);
//# sourceMappingURL=chunk-1c7ada22.4e6ab674.js.map